<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WATEN Admin Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg-dark: #0a0a0a;
  --bg-card: #141414;
  --accent: #c9a227;
  --accent-hover: #d4af37;
  --text: #f5f5f5;
  --text-muted: rgba(255,255,255,0.65);
  --border: rgba(255,255,255,0.08);
  --success: #28a745;
  --warning: #ffc107;
  --danger: #dc3545;
}

* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  background: var(--bg-dark); color: var(--text);
  font-family: 'DM Sans', sans-serif; line-height: 1.6;
  overflow-x: hidden;
}

.dashboard-header {
  background: linear-gradient(135deg, #1a1a2e 0%, #0f0f1e 100%);
  padding: 1.5rem 2rem; border-bottom: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
}

.dashboard-title {
  font-family: 'Cormorant Garamond', serif; font-size: 2rem;
  font-weight: 700; letter-spacing: 0.1em; color: var(--accent);
}

.header-stats {
  display: flex; gap: 2rem;
}

.stat-card {
  background: var(--bg-card); padding: 1rem 1.5rem; border-radius: 8px;
  border: 1px solid var(--border); text-align: center;
}

.stat-number {
  font-size: 1.5rem; font-weight: 700; color: var(--accent);
}

.stat-label {
  font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase;
  letter-spacing: 0.1em; margin-top: 0.25rem;
}

.dashboard-content {
  display: grid; grid-template-columns: 1fr 350px;
  gap: 2rem; padding: 2rem; max-width: 1400px; margin: 0 auto;
}

.orders-section {
  background: var(--bg-card); border-radius: 12px;
  border: 1px solid var(--border); overflow: hidden;
}

.section-header {
  padding: 1.5rem; border-bottom: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
}

.section-title {
  font-size: 1.2rem; font-weight: 600; color: var(--text);
}

.filters {
  display: flex; gap: 1rem; align-items: center;
}

.filter-select {
  background: var(--bg-dark); color: var(--text); border: 1px solid var(--border);
  padding: 0.5rem 1rem; border-radius: 6px; font-size: 0.9rem;
}

.search-box {
  background: var(--bg-dark); color: var(--text); border: 1px solid var(--border);
  padding: 0.5rem 1rem; border-radius: 6px; font-size: 0.9rem;
  width: 200px;
}

.orders-list {
  max-height: 600px; overflow-y: auto;
}

.order-item {
  padding: 1.5rem; border-bottom: 1px solid var(--border);
  transition: background 0.2s ease;
}

.order-item:hover {
  background: rgba(201, 162, 39, 0.05);
}

.order-header {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 1rem;
}

.order-id {
  font-weight: 700; color: var(--accent); font-size: 1.1rem;
}

.order-status {
  padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem;
  font-weight: 600; text-transform: uppercase;
}

.status-pending { background: var(--warning); color: #000; }
.status-confirmed { background: var(--success); color: #fff; }
.status-shipped { background: #007bff; color: #fff; }
.status-delivered { background: #28a745; color: #fff; }

.order-details {
  display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;
  margin-bottom: 1rem;
}

.detail-group {
  display: flex; flex-direction: column; gap: 0.5rem;
}

.detail-label {
  font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase;
  letter-spacing: 0.1em;
}

.detail-value {
  font-weight: 500; color: var(--text);
}

.sidebar {
  display: flex; flex-direction: column; gap: 2rem;
}

.notifications-panel {
  background: var(--bg-card); border-radius: 12px;
  border: 1px solid var(--border); overflow: hidden;
}

.notifications-list {
  max-height: 300px; overflow-y: auto; padding: 1rem;
}

.notification-item {
  background: var(--bg-dark); padding: 1rem; border-radius: 8px;
  margin-bottom: 1rem; border-left: 3px solid var(--accent);
}

.notification-time {
  font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.5rem;
}

.notification-message {
  font-size: 0.9rem; color: var(--text);
}

.actions-panel {
  background: var(--bg-card); border-radius: 12px;
  border: 1px solid var(--border); padding: 1.5rem;
}

.action-btn {
  width: 100%; padding: 0.75rem; border: none; border-radius: 6px;
  font-weight: 600; cursor: pointer; margin-bottom: 1rem;
  transition: all 0.2s ease;
}

.btn-primary {
  background: var(--accent); color: var(--bg-dark);
}

.btn-primary:hover {
  background: var(--accent-hover); transform: translateY(-1px);
}

.btn-secondary {
  background: var(--bg-dark); color: var(--text);
  border: 1px solid var(--border);
}

.btn-secondary:hover {
  background: #1a1a2e; border-color: var(--accent);
}

.modal {
  display: none; position: fixed; top: 0; left: 0; width: 100%;
  height: 100%; background: rgba(0,0,0,0.8); z-index: 10000;
  justify-content: center; align-items: center;
}

.modal-content {
  background: var(--bg-card); border-radius: 12px; padding: 2rem;
  max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;
  border: 1px solid var(--border);
}

.modal-header {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 1.5rem;
}

.modal-title {
  font-size: 1.3rem; font-weight: 600; color: var(--text);
}

.close-btn {
  background: none; border: none; color: var(--text-muted);
  font-size: 1.5rem; cursor: pointer;
}

.close-btn:hover {
  color: var(--text);
}

.panel {
  display: none !important;
}

.panel.active {
  display: block !important;
}

.nav-item {
  display: block; padding: 0.75rem 1.5rem; color: var(--text-muted);
  text-decoration: none; font-size: 0.9rem; transition: all 0.2s ease;
  border-left: 3px solid transparent;
}

.nav-item:hover {
  background: rgba(201, 162, 39, 0.1); color: var(--text);
}

.nav-item.active {
  background: rgba(201, 162, 39, 0.15); color: var(--accent);
  border-left-color: var(--accent);
}

.section-card {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem;
}

.section-card h3 {
  color: var(--accent); font-size: 1.1rem; margin-bottom: 1rem;
  font-weight: 600;
}

.form-row {
  margin-bottom: 1rem;
}

.form-row label {
  display: block; color: var(--text-muted); font-size: 0.9rem;
  margin-bottom: 0.5rem; font-weight: 500;
}

.form-row input,
.form-row textarea {
  width: 100%; padding: 0.75rem; background: var(--bg-dark);
  border: 1px solid var(--border); color: var(--text); border-radius: 6px;
  font-size: 0.9rem; transition: border-color 0.2s ease;
}

.form-row input:focus,
.form-row textarea:focus {
  outline: none; border-color: var(--accent);
}

.products-list {
  background: var(--bg-card); border: 1px solid var(--border);
  border-radius: 12px; padding: 1rem;
}

.product-item {
  display: flex; align-items: center; gap: 1rem; padding: 1rem;
  border-bottom: 1px solid var(--border); transition: background 0.2s ease;
}

.product-item:last-child {
  border-bottom: none;
}

.product-item:hover {
  background: rgba(201, 162, 39, 0.05);
}

.product-image {
  width: 60px; height: 60px; object-fit: cover; border-radius: 8px;
  background: var(--bg-dark);
}

.product-info {
  flex: 1;
}

.product-name {
  font-weight: 600; color: var(--text); margin-bottom: 0.25rem;
}

.product-price {
  color: var(--accent); font-weight: 500;
}

.product-actions {
  display: flex; gap: 0.5rem;
}

.btn-small {
  padding: 0.4rem 0.8rem; font-size: 0.8rem; border: none;
  border-radius: 4px; cursor: pointer; font-weight: 500;
}

.btn-edit {
  background: var(--accent); color: var(--bg-dark);
}

.btn-delete {
  background: var(--danger); color: white;
}

/* Mobile Responsiveness for Admin Dashboard */
@media (max-width: 768px) {
  .dashboard-header {
    flex-direction: column;
    gap: 1rem;
    text-align: center;
  }
  
  .dashboard-title {
    font-size: 1.5rem;
  }
  
  .header-stats {
    grid-template-columns: 1fr;
    gap: 0.75rem;
    width: 100%;
  }
  
  .orders-section {
    flex-direction: column;
  }
  
  .filters {
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .filter-select,
  .search-box {
    width: 100%;
  }
  
  .sidebar {
    width: 100%;
    margin-top: 2rem;
  }
  
  .dashboard-content > div {
    flex-direction: column;
  }
  
  nav {
    width: 100%;
    display: flex;
    overflow-x: auto;
    padding: 0.5rem;
  }
  
  .nav-item {
    flex-shrink: 0;
    padding: 0.5rem 1rem;
    font-size: 0.8rem;
  }
  
  .section-card {
    padding: 1rem;
  }
  
  .form-row {
    grid-template-columns: 1fr;
  }
  
  .products-list {
    gap: 0.5rem;
  }
  
  .product-item {
    flex-direction: column;
    text-align: center;
    gap: 0.75rem;
  }
  
  .product-actions {
    justify-content: center;
  }
  
  .order-item {
    flex-direction: column;
    gap: 1rem;
  }
  
  .order-details {
    text-align: center;
  }
  
  .modal-content {
    padding: 1rem;
    margin: 1rem;
    max-width: none;
  }
  
  .action-btn {
    padding: 0.6rem 1rem;
    font-size: 0.8rem;
  }
}

@media (max-width: 480px) {
  .dashboard-title {
    font-size: 1.25rem;
  }
  
  .section-title {
    font-size: 1.1rem;
  }
  
  .stat-card {
    padding: 1rem;
  }
  
  .stat-number {
    font-size: 1.5rem;
  }
  
  .order-item {
    padding: 0.75rem;
  }
  
  .product-item {
    padding: 0.75rem;
  }
  
  .btn-small {
    padding: 0.3rem 0.6rem;
    font-size: 0.7rem;
  }
  
  .action-btn {
    padding: 0.5rem 0.8rem;
    font-size: 0.75rem;
  }
  
  .form-row input,
  .form-row textarea {
    font-size: 0.85rem;
  }
}

@media (max-width: 1024px) {
  .dashboard-content {
    grid-template-columns: 1fr;
  }
  
  .header-stats {
    display: none;
  }
  
  div[style*="display: flex"] {
    flex-direction: column;
  }
  
  nav {
    width: 100%; flex-direction: row; overflow-x: auto;
  }
  
  .nav-item {
    white-space: nowrap; border-left: none; border-bottom: 3px solid transparent;
  }
  
  .nav-item.active {
    border-left: none; border-bottom-color: var(--accent);
  }
}

@media (max-width: 768px) {
  .dashboard-header {
    flex-direction: column; gap: 1rem;
  }
  
  .filters {
    flex-direction: column; align-items: stretch;
  }
  
  .search-box {
    width: 100%;
  }
}
</style>
</head>
<body>

<!-- Login Screen -->
<div id="login-screen" style="
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: linear-gradient(135deg, #1a1a2e 0%, #0f0f1e 100%);
  display: flex; justify-content: center; align-items: center; z-index: 20000;
">
  <div class="login-box">
    <h2 style="color: var(--accent); font-family: 'Cormorant Garamond', serif; font-size: 2rem; margin-bottom: 2rem; text-align: center; letter-spacing: 0.1em;">üéØ WATEN ADMIN</h2>
    <p style="color: var(--text-muted); margin-bottom: 2rem; text-align: center;">Enter password to access dashboard</p>
    <input type="password" id="admin-password" placeholder="Enter password" style="
      width: 100%; padding: 1rem; background: var(--bg-dark); border: 1px solid var(--accent);
      color: var(--text); font-size: 1rem; border-radius: 8px; margin-bottom: 1rem;
    ">
    <button onclick="checkPassword()" style="
      width: 100%; padding: 1rem; background: var(--accent); color: var(--bg-dark);
      border: none; border-radius: 8px; font-weight: 600; cursor: pointer;
      font-size: 1rem; transition: all 0.2s ease;
    ">Access Dashboard</button>
    <div id="login-error" style="
      color: var(--danger); margin-top: 1rem; text-align: center;
      font-size: 0.9rem; display: none;
    ">Incorrect password. Please try again.</div>
  </div>
</div>

<!-- Dashboard Content (Hidden until login) -->
<div id="dashboard-content" style="display: none;">
  <!-- Dashboard Navigation -->
  <div style="display: flex; min-height: calc(100vh - 80px);">
    <!-- Sidebar -->
    <nav style="width: 220px; background: var(--bg-dark); border-right: 1px solid var(--border); padding: 1rem 0;">
      <a href="#" class="nav-item active" data-panel="orders" onclick="switchPanel('orders')">
        üìã Orders
      </a>
      <a href="#" class="nav-item" data-panel="products" onclick="switchPanel('products')">
        üëï Products
      </a>
      <a href="#" class="nav-item" data-panel="content" onclick="switchPanel('content')">
        üìù Content
      </a>
      <a href="#" class="nav-item" data-panel="settings" onclick="switchPanel('settings')">
        ‚öôÔ∏è Settings
      </a>
    </nav>

    <!-- Main Content Area -->
    <div style="flex: 1; padding: 2rem;">
      <!-- Orders Panel -->
      <div id="panel-orders" class="panel active">
        <header class="dashboard-header">
          <h1 class="dashboard-title">üéØ WATEN ADMIN</h1>
          <div class="header-stats">
            <div class="stat-card">
              <div class="stat-number" id="total-orders">0</div>
              <div class="stat-label">Total Orders</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="total-revenue">0</div>
              <div class="stat-label">Revenue (TND)</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="pending-orders">0</div>
              <div class="stat-label">Pending</div>
            </div>
          </div>
        </header>

        <!-- Orders Section -->
        <section class="orders-section">
          <div class="section-header">
            <h2 class="section-title">Orders</h2>
            <div class="filters">
              <select class="filter-select" id="status-filter">
                <option value="all">All Status</option>
                <option value="pending">Pending</option>
                <option value="confirmed">Confirmed</option>
                <option value="shipped">Shipped</option>
                <option value="delivered">Delivered</option>
              </select>
              <input type="text" class="search-box" id="search-box" placeholder="Search orders...">
            </div>
          </div>
          <div class="orders-list" id="orders-list">
            <!-- Orders will be populated here -->
          </div>
        </section>

        <!-- Sidebar -->
        <aside class="sidebar">
          <!-- Notifications Panel -->
          <div class="notifications-panel">
            <div class="section-header">
              <h3 class="section-title">Notifications</h3>
            </div>
            <div class="notifications-list" id="notifications-list">
              <!-- Notifications will be populated here -->
            </div>
          </div>

          <!-- Actions Panel -->
          <div class="actions-panel">
            <h3 class="section-title" style="margin-bottom: 1rem;">Actions</h3>
            <button class="action-btn btn-primary" onclick="refreshData()">üîÑ Refresh Data</button>
            <button class="action-btn btn-secondary" onclick="exportOrders()">üì• Export Orders</button>
            <button class="action-btn btn-secondary" onclick="clearNotifications()">üóëÔ∏è Clear Notifications</button>
          </div>
        </aside>
      </div>

      <!-- Products Panel -->
      <div id="panel-products" class="panel">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
          <h2 class="section-title">Products Management</h2>
          <button class="action-btn btn-secondary" onclick="loadProducts()">üîÑ Refresh Products</button>
        </div>
        <div class="section-card">
          <h3>Add New Product</h3>
          <div class="form-row">
            <label>Product Name</label>
            <input type="text" id="new-product-name" placeholder="e.g. Black Essential Hoodie">
          </div>
          <div class="form-row">
            <label>Price (TND)</label>
            <input type="number" id="new-product-price" placeholder="120" min="0">
          </div>
          <div class="form-row">
            <label>Product Image</label>
            <div style="display: flex; gap: 1rem; align-items: center;">
              <input type="file" id="new-product-image-file" accept="image/*" onchange="handleImageUpload(event)" style="display: none;">
              <button type="button" class="action-btn btn-secondary" onclick="document.getElementById('new-product-image-file').click()">
                üìÅ Upload Image
              </button>
              <input type="text" id="new-product-image" placeholder="https://..." style="flex: 1;">
            </div>
            <div id="image-preview" style="margin-top: 1rem; display: none;">
              <img id="preview-img" style="max-width: 200px; max-height: 200px; border-radius: 8px; border: 1px solid var(--border);">
              <button type="button" class="btn-small" onclick="clearImagePreview()" style="margin-left: 1rem;">Clear</button>
            </div>
          </div>
          <button class="action-btn btn-primary" onclick="addProduct()">Add Product</button>
        </div>
        <div class="products-list" id="products-list">
          <!-- Products will be populated here -->
        </div>
      </div>

      <!-- Content Panel -->
      <div id="panel-content" class="panel">
        <h2 class="section-title">Website Content Management</h2>
        
        <!-- SEO & Meta -->
        <div class="section-card">
          <h3>SEO & Meta Information</h3>
          <div class="form-row">
            <label>Page Title</label>
            <input type="text" id="meta-title" placeholder="WATEN | Global Streetwear">
          </div>
          <div class="form-row">
            <label>Meta Description</label>
            <textarea id="meta-description" rows="2" placeholder="WATEN ‚Äî Premium streetwear built for global dominance. Limited drops. Strong brand identity."></textarea>
          </div>
        </div>

        <!-- Header & Navigation -->
        <div class="section-card">
          <h3>Header & Navigation</h3>
          <div class="form-row">
            <label>Logo Text</label>
            <input type="text" id="site-logo" placeholder="WATEN">
          </div>
          <div class="form-row">
            <label>Navigation Links (one per line: text|url)</label>
            <textarea id="site-nav" rows="3" placeholder="COLLECTION|#collection&#10;INVEST|#invest&#10;Account|#"></textarea>
          </div>
        </div>

        <!-- Hero Section -->
        <div class="section-card">
          <h3>Hero Section</h3>
          <div class="form-row">
            <label>Main Title</label>
            <input type="text" id="hero-title" placeholder="WATEN">
          </div>
          <div class="form-row">
            <label>Tagline</label>
            <input type="text" id="hero-tagline" placeholder="Built for global dominance">
          </div>
          <div class="form-row">
            <label>Button Text</label>
            <input type="text" id="hero-cta" placeholder="Shop Now">
          </div>
        </div>

        <!-- Collection Section -->
        <div class="section-card">
          <h3>Collection Section</h3>
          <div class="form-row">
            <label>Section Heading</label>
            <input type="text" id="collection-heading" placeholder="New Drop">
          </div>
          <div class="form-row">
            <label>Section Subtitle</label>
            <input type="text" id="collection-subtitle" placeholder="Limited edition pieces ‚Äî available now">
          </div>
        </div>

        <!-- Invest Section -->
        <div class="section-card">
          <h3>Invest Section</h3>
          <div class="form-row">
            <label>Section Heading</label>
            <input type="text" id="invest-heading" placeholder="Invest in WATEN">
          </div>
          <div class="form-row">
            <label>Section Body</label>
            <textarea id="invest-body" rows="4" placeholder="WATEN is positioned for aggressive expansion across Tunisia and international markets..."></textarea>
          </div>
          <div class="form-row">
            <label>Button Text</label>
            <input type="text" id="invest-cta" placeholder="Request Pitch Deck">
          </div>
        </div>

        <!-- Footer -->
        <div class="section-card">
          <h3>Footer</h3>
          <div class="form-row">
            <label>Footer Logo</label>
            <input type="text" id="footer-logo" placeholder="WATEN">
          </div>
          <div class="form-row">
            <label>Footer Tagline</label>
            <input type="text" id="footer-tagline" placeholder="Premium streetwear. Limited drops. Global reach.">
          </div>
          <div class="form-row">
            <label>Footer Links (one per line: text|url)</label>
            <textarea id="footer-links" rows="2" placeholder="Collection|#collection&#10;Invest|#invest"></textarea>
          </div>
          <div class="form-row">
            <label>Copyright Text</label>
            <input type="text" id="footer-copyright" placeholder="¬© 2026 WATEN ‚Äî Global Streetwear">
          </div>
        </div>

        <button class="action-btn btn-primary" onclick="saveContent()">üíæ Save All Content</button>
        <button class="action-btn btn-secondary" onclick="loadContent()">üîÑ Reload Content</button>
      </div>

      <!-- Settings Panel -->
      <div id="panel-settings" class="panel">
        <h2 class="section-title">Settings & Configuration</h2>
        
        <div class="section-card">
          <h3>Contact Information</h3>
          <div class="form-row">
            <label>WhatsApp</label>
            <input type="text" id="contact-whatsapp" placeholder="https://wa.me/216...">
          </div>
          <div class="form-row">
            <label>Instagram</label>
            <input type="text" id="contact-instagram" placeholder="https://instagram.com/...">
          </div>
          <div class="form-row">
            <label>TikTok</label>
            <input type="text" id="contact-tiktok" placeholder="https://tiktok.com/@...">
          </div>
          <div class="form-row">
            <label>Email</label>
            <input type="text" id="contact-email" placeholder="contact@waten.com">
          </div>
        </div>

        <div class="section-card">
          <h3>Security</h3>
          <div class="form-row">
            <label>Change Admin Password</label>
            <input type="password" id="new-admin-password" placeholder="New password">
          </div>
        </div>

        <div class="section-card">
          <h3>System Management</h3>
          <div style="display: flex; gap: 1rem; margin-top: 1rem;">
            <button class="action-btn btn-secondary" onclick="clearAllData()">üóëÔ∏è Clear All Data</button>
            <button class="action-btn btn-secondary" onclick="exportAllData()">üì• Export All Data</button>
            <button class="action-btn btn-secondary" onclick="resetToDefaults()">üîÑ Reset to Defaults</button>
          </div>
        </div>

        <button class="action-btn btn-primary" onclick="saveSettings()">üíæ Save Settings</button>
        <button class="action-btn btn-secondary" onclick="loadSettings()">üîÑ Reload Settings</button>
      </div>
    </div>
  </div>
</div>

<!-- Order Details Modal -->
<div class="modal" id="order-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">Order Details</h3>
      <button class="close-btn" onclick="closeModal('order-modal')">&times;</button>
    </div>
    <div id="order-details-content">
      <!-- Order details will be populated here -->
    </div>
  </div>
</div>
</div>

<script>
// Password Protection
const ADMIN_PASSWORD = 'waten123'; // Change this to your desired password

function checkPassword() {
  const passwordInput = document.getElementById('admin-password');
  const loginError = document.getElementById('login-error');
  const loginScreen = document.getElementById('login-screen');
  const dashboardContent = document.getElementById('dashboard-content');
  
  if (passwordInput.value === ADMIN_PASSWORD) {
    loginScreen.style.display = 'none';
    dashboardContent.style.display = 'block';
    initializeDashboard();
  } else {
    loginError.style.display = 'block';
    passwordInput.value = '';
    passwordInput.focus();
  }
}

// Allow Enter key to submit password
document.addEventListener('DOMContentLoaded', function() {
  const passwordInput = document.getElementById('admin-password');
  if (passwordInput) {
    passwordInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        checkPassword();
      }
    });
    passwordInput.focus();
  }
});

function initializeDashboard() {
  // Initialize dashboard only after successful login
  loadData();
  setupEventListeners();
  startRealTimeUpdates();
  loadProducts();
  loadContent();
  loadSettings();
}

// Panel Switching
function switchPanel(panelName) {
  console.log('Switching to panel:', panelName);
  
  // Hide all panels
  document.querySelectorAll('.panel').forEach(panel => {
    panel.classList.remove('active');
    console.log('Hiding panel:', panel.id);
  });
  
  // Remove active class from all nav items
  document.querySelectorAll('.nav-item').forEach(item => {
    item.classList.remove('active');
  });
  
  // Show selected panel
  const selectedPanel = document.getElementById('panel-' + panelName);
  if (selectedPanel) {
    selectedPanel.classList.add('active');
    console.log('Showing panel:', selectedPanel.id);
    
    // Load content for specific panels
    if (panelName === 'content') {
      loadContent();
    } else if (panelName === 'settings') {
      loadSettings();
    }
  } else {
    console.error('Panel not found:', 'panel-' + panelName);
  }
  
  // Add active class to selected nav item
  const selectedNav = document.querySelector(`[data-panel="${panelName}"]`);
  if (selectedNav) {
    selectedNav.classList.add('active');
  }
}

// Image Upload Functions
let uploadedImageData = null;

function handleImageUpload(event) {
  const file = event.target.files[0];
  if (!file) return;
  
  // Check if file is an image
  if (!file.type.startsWith('image/')) {
    showNotification('Please select a valid image file', 'error');
    return;
  }
  
  // Check file size (max 5MB)
  if (file.size > 5 * 1024 * 1024) {
    showNotification('Image size should be less than 5MB', 'error');
    return;
  }
  
  const reader = new FileReader();
  reader.onload = function(e) {
    uploadedImageData = e.target.result;
    
    // Show preview
    const preview = document.getElementById('image-preview');
    const previewImg = document.getElementById('preview-img');
    previewImg.src = uploadedImageData;
    preview.style.display = 'block';
    
    // Update the URL field with base64 data
    document.getElementById('new-product-image').value = uploadedImageData;
    
    showNotification('Image uploaded successfully');
  };
  
  reader.onerror = function() {
    showNotification('Error reading image file', 'error');
  };
  
  reader.readAsDataURL(file);
}

function clearImagePreview() {
  uploadedImageData = null;
  document.getElementById('image-preview').style.display = 'none';
  document.getElementById('preview-img').src = '';
  document.getElementById('new-product-image').value = '';
  document.getElementById('new-product-image-file').value = '';
  showNotification('Image cleared');
}

// Enhanced addProduct function to handle uploaded images
function addProduct() {
  const name = document.getElementById('new-product-name').value.trim();
  const price = parseInt(document.getElementById('new-product-price').value);
  const image = document.getElementById('new-product-image').value.trim();
  
  if (!name || !price || !image) {
    showNotification('Please fill in all product fields', 'error');
    return;
  }
  
  const newProduct = {
    id: Date.now(),
    name: name,
    price: price,
    image: image
  };
  
  products.push(newProduct);
  localStorage.setItem('watenProducts', JSON.stringify(products));
  renderProducts();
  
  // Clear form
  document.getElementById('new-product-name').value = '';
  document.getElementById('new-product-price').value = '';
  document.getElementById('new-product-image').value = '';
  clearImagePreview();
  
  showNotification('Product added successfully');
}

// Products Management
let products = [];

function loadProducts() {
  const storedProducts = localStorage.getItem('watenProducts');
  products = storedProducts ? JSON.parse(storedProducts) : [
    { id: 1, name: 'Black Essential Hoodie', price: 120, image: 'https://images.unsplash.com/photo-1602810319428-019690571b5b' },
    { id: 2, name: 'Oversized Street Tee', price: 80, image: 'https://images.unsplash.com/photo-1593032465171-8f8b8fdd6b47' },
    { id: 3, name: 'Limited Varsity Jacket', price: 250, image: 'images/iyadh.jpg' },
    { id: 4, name: 'Tataouine 3200 Hoodie', price: 140, image: '12.png' }
  ];
  renderProducts();
  showNotification(`Loaded ${products.length} products`);
}

function renderProducts() {
  const productsList = document.getElementById('products-list');
  
  if (products.length === 0) {
    productsList.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--text-muted);">No products yet. Add your first product above.</div>';
    return;
  }
  
  productsList.innerHTML = products.map(product => `
    <div class="product-item">
      <img src="${product.image}" alt="${product.name}" class="product-image" onerror="this.src='https://images.unsplash.com/photo-1556821840-3a63f95609a7'">
      <div class="product-info">
        <div class="product-name">${product.name}</div>
        <div class="product-price">${product.price} TND</div>
      </div>
      <div class="product-actions">
        <button class="btn-small btn-edit" onclick="editProduct(${product.id})">Edit</button>
        <button class="btn-small btn-delete" onclick="deleteProduct(${product.id})">Delete</button>
      </div>
    </div>
  `).join('');
}

function addProduct() {
  const name = document.getElementById('new-product-name').value.trim();
  const price = parseInt(document.getElementById('new-product-price').value);
  const image = document.getElementById('new-product-image').value.trim();
  
  if (!name || !price) {
    showNotification('Please fill in product name and price');
    return;
  }
  
  const newProduct = {
    id: Date.now(),
    name: name,
    price: price,
    image: image || 'https://images.unsplash.com/photo-1556821840-3a63f95609a7'
  };
  
  products.push(newProduct);
  localStorage.setItem('watenProducts', JSON.stringify(products));
  
  // Clear form
  document.getElementById('new-product-name').value = '';
  document.getElementById('new-product-price').value = '';
  document.getElementById('new-product-image').value = '';
  
  renderProducts();
  showNotification('Product added successfully');
}

function editProduct(id) {
  const product = products.find(p => p.id === id);
  if (!product) return;
  
  // Create edit modal
  const modal = document.createElement('div');
  modal.className = 'modal';
  modal.style.display = 'flex';
  modal.innerHTML = `
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Edit Product</h3>
        <button class="close-btn" onclick="closeEditModal()">&times;</button>
      </div>
      <div class="form-row">
        <label>Product Name</label>
        <input type="text" id="edit-product-name" value="${product.name}">
      </div>
      <div class="form-row">
        <label>Price (TND)</label>
        <input type="number" id="edit-product-price" value="${product.price}" min="0">
      </div>
      <div class="form-row">
        <label>Product Image</label>
        <div style="display: flex; gap: 1rem; align-items: center;">
          <input type="file" id="edit-product-image-file" accept="image/*" onchange="handleEditImageUpload(event)" style="display: none;">
          <button type="button" class="action-btn btn-secondary" onclick="document.getElementById('edit-product-image-file').click()">
            üìÅ Upload New Image
          </button>
          <input type="text" id="edit-product-image" value="${product.image}" style="flex: 1;">
        </div>
        <div id="edit-image-preview" style="margin-top: 1rem;">
          <img id="edit-preview-img" src="${product.image}" style="max-width: 200px; max-height: 200px; border-radius: 8px; border: 1px solid var(--border);">
        </div>
      </div>
      <div style="display: flex; gap: 1rem; margin-top: 1rem;">
        <button class="action-btn btn-primary" onclick="saveProductEdit(${id})">Save Changes</button>
        <button class="action-btn btn-secondary" onclick="closeEditModal()">Cancel</button>
      </div>
    </div>
  `;
  
  document.body.appendChild(modal);
}

function handleEditImageUpload(event) {
  const file = event.target.files[0];
  if (!file) return;
  
  if (!file.type.startsWith('image/')) {
    showNotification('Please select a valid image file', 'error');
    return;
  }
  
  if (file.size > 5 * 1024 * 1024) {
    showNotification('Image size should be less than 5MB', 'error');
    return;
  }
  
  const reader = new FileReader();
  reader.onload = function(e) {
    const imageData = e.target.result;
    document.getElementById('edit-preview-img').src = imageData;
    document.getElementById('edit-product-image').value = imageData;
    showNotification('Image uploaded successfully');
  };
  
  reader.readAsDataURL(file);
}

function saveProductEdit(id) {
  const product = products.find(p => p.id === id);
  if (!product) return;
  
  const name = document.getElementById('edit-product-name').value.trim();
  const price = parseInt(document.getElementById('edit-product-price').value);
  const image = document.getElementById('edit-product-image').value.trim();
  
  if (!name || !price || !image) {
    showNotification('Please fill in all product fields', 'error');
    return;
  }
  
  product.name = name;
  product.price = price;
  product.image = image;
  
  localStorage.setItem('watenProducts', JSON.stringify(products));
  renderProducts();
  closeEditModal();
  showNotification('Product updated successfully');
}

function closeEditModal() {
  const modal = document.querySelector('.modal');
  if (modal) modal.remove();
}

function deleteProduct(id) {
  if (!confirm('Are you sure you want to delete this product?')) return;
  
  products = products.filter(p => p.id !== id);
  localStorage.setItem('watenProducts', JSON.stringify(products));
  renderProducts();
  showNotification('Product deleted successfully');
}

// Content Management
function loadContent() {
  const storedContent = localStorage.getItem('watenContent');
  const content = storedContent ? JSON.parse(storedContent) : {
    metaTitle: 'WATEN | Global Streetwear',
    metaDescription: 'WATEN ‚Äî Premium streetwear built for global dominance. Limited drops. Strong brand identity.',
    logo: 'WATEN',
    nav: 'COLLECTION|#collection\nINVEST|#invest\nAccount|#',
    heroTitle: 'WATEN',
    heroTagline: 'Built for global dominance',
    heroCta: 'Shop Now',
    collectionHeading: 'New Drop',
    collectionSubtitle: 'Limited edition pieces ‚Äî available now',
    investHeading: 'Invest in WATEN',
    investBody: 'WATEN is positioned for aggressive expansion across Tunisia and international markets. High-margin model. Limited drops. Strong brand identity. Seeking strategic investors to scale retail and global distribution.',
    investCta: 'Request Pitch Deck',
    footerLogo: 'WATEN',
    footerTagline: 'Premium streetwear. Limited drops. Global reach.',
    footerLinks: 'Collection|#collection\nInvest|#invest',
    footerCopyright: '¬© 2026 WATEN ‚Äî Global Streetwear'
  };
  
  // Load all content fields
  document.getElementById('meta-title').value = content.metaTitle || '';
  document.getElementById('meta-description').value = content.metaDescription || '';
  document.getElementById('site-logo').value = content.logo || '';
  document.getElementById('site-nav').value = content.nav || '';
  document.getElementById('hero-title').value = content.heroTitle || '';
  document.getElementById('hero-tagline').value = content.heroTagline || '';
  document.getElementById('hero-cta').value = content.heroCta || '';
  document.getElementById('collection-heading').value = content.collectionHeading || '';
  document.getElementById('collection-subtitle').value = content.collectionSubtitle || '';
  document.getElementById('invest-heading').value = content.investHeading || '';
  document.getElementById('invest-body').value = content.investBody || '';
  document.getElementById('invest-cta').value = content.investCta || '';
  document.getElementById('footer-logo').value = content.footerLogo || '';
  document.getElementById('footer-tagline').value = content.footerTagline || '';
  document.getElementById('footer-links').value = content.footerLinks || '';
  document.getElementById('footer-copyright').value = content.footerCopyright || '';
}

function saveContent() {
  const content = {
    metaTitle: document.getElementById('meta-title').value,
    metaDescription: document.getElementById('meta-description').value,
    logo: document.getElementById('site-logo').value,
    nav: document.getElementById('site-nav').value,
    heroTitle: document.getElementById('hero-title').value,
    heroTagline: document.getElementById('hero-tagline').value,
    heroCta: document.getElementById('hero-cta').value,
    collectionHeading: document.getElementById('collection-heading').value,
    collectionSubtitle: document.getElementById('collection-subtitle').value,
    investHeading: document.getElementById('invest-heading').value,
    investBody: document.getElementById('invest-body').value,
    investCta: document.getElementById('invest-cta').value,
    footerLogo: document.getElementById('footer-logo').value,
    footerTagline: document.getElementById('footer-tagline').value,
    footerLinks: document.getElementById('footer-links').value,
    footerCopyright: document.getElementById('footer-copyright').value
  };
  
  // Save to localStorage
  localStorage.setItem('watenContent', JSON.stringify(content));
  
  // Apply changes to main site (if it's open in same browser)
  applyContentToSite(content);
  
  showNotification('Content saved successfully! Changes applied to website.');
}

function applyContentToSite(content) {
  // This function will be called by the main site to load content
  // The main site will have a corresponding function to apply this content
  try {
    // Update page title and meta
    if (document.title) document.title = content.metaTitle;
    const metaDesc = document.querySelector('meta[name="description"]');
    if (metaDesc) metaDesc.setAttribute('content', content.metaDescription);
    
    // Update all content elements
    updateElement('header-logo', content.logo);
    updateElement('hero-title', content.heroTitle);
    updateElement('hero-tagline', content.heroTagline);
    updateElement('hero-cta', content.heroCta);
    updateElement('collection-heading', content.collectionHeading);
    updateElement('collection-subtitle', content.collectionSubtitle);
    updateElement('invest-heading', content.investHeading);
    updateElement('invest-body', content.investBody);
    updateElement('invest-cta', content.investCta);
    updateElement('footer-logo', content.footerLogo);
    updateElement('footer-tagline', content.footerTagline);
    updateElement('footer-copyright', content.footerCopyright);
    
    // Update navigation
    if (content.nav) {
      const navLinks = content.nav.split('\n').filter(link => link.trim());
      const navElement = document.getElementById('header-nav');
      if (navElement) {
        navElement.innerHTML = navLinks.map(link => {
          const [text, url] = link.split('|');
          return `<a href="${url || '#'}">${text}</a>`;
        }).join('');
      }
    }
    
    // Update footer links
    if (content.footerLinks) {
      const footerLinks = content.footerLinks.split('\n').filter(link => link.trim());
      const footerElement = document.getElementById('footer-links');
      if (footerElement) {
        footerElement.innerHTML = footerLinks.map(link => {
          const [text, url] = link.split('|');
          return `<a href="${url || '#'}">${text}</a>`;
        }).join('');
      }
    }
    
  } catch (e) {
    console.log('Content updates will be applied when main site is refreshed');
  }
}

function updateElement(id, content) {
  const element = document.getElementById(id);
  if (element) element.textContent = content;
}

// Settings Management
function loadSettings() {
  const storedSettings = localStorage.getItem('watenSettings');
  const settings = storedSettings ? JSON.parse(storedSettings) : {
    whatsapp: '',
    instagram: '',
    tiktok: '',
    email: ''
  };
  
  document.getElementById('contact-whatsapp').value = settings.whatsapp || '';
  document.getElementById('contact-instagram').value = settings.instagram || '';
  document.getElementById('contact-tiktok').value = settings.tiktok || '';
  document.getElementById('contact-email').value = settings.email || '';
}

function saveSettings() {
  const newPassword = document.getElementById('new-admin-password').value;
  
  if (newPassword) {
    // Update admin password
    const script = document.createElement('script');
    script.textContent = `const ADMIN_PASSWORD = '${newPassword}';`;
    document.head.appendChild(script);
    showNotification('Admin password updated successfully');
  }
  
  const settings = {
    whatsapp: document.getElementById('contact-whatsapp').value,
    instagram: document.getElementById('contact-instagram').value,
    tiktok: document.getElementById('contact-tiktok').value,
    email: document.getElementById('contact-email').value
  };
  
  localStorage.setItem('watenSettings', JSON.stringify(settings));
  
  // Update footer social links
  updateSocialLinks(settings);
  
  // Clear password field
  document.getElementById('new-admin-password').value = '';
  
  showNotification('Settings saved successfully');
}

function updateSocialLinks(settings) {
  // Update social links in main site (if open)
  try {
    const whatsappLink = document.getElementById('footer-whatsapp');
    const instagramLink = document.getElementById('footer-instagram');
    const tiktokLink = document.getElementById('footer-tiktok');
    const emailLink = document.getElementById('footer-email');
    
    if (whatsappLink && settings.whatsapp) {
      whatsappLink.href = settings.whatsapp;
      whatsappLink.style.display = 'block';
    }
    if (instagramLink && settings.instagram) {
      instagramLink.href = settings.instagram;
      instagramLink.style.display = 'block';
    }
    if (tiktokLink && settings.tiktok) {
      tiktokLink.href = settings.tiktok;
      tiktokLink.style.display = 'block';
    }
    if (emailLink && settings.email) {
      emailLink.href = `mailto:${settings.email}`;
      emailLink.style.display = 'block';
    }
  } catch (e) {
    console.log('Social links will be updated when main site is refreshed');
  }
}

function clearAllData() {
  if (!confirm('‚ö†Ô∏è WARNING: This will delete ALL orders, products, content, and settings. Are you absolutely sure?')) return;
  
  if (!confirm('üö® FINAL WARNING: This action cannot be undone. All data will be permanently deleted. Continue?')) return;
  
  localStorage.removeItem('watenOrders');
  localStorage.removeItem('watenNotifications');
  localStorage.removeItem('watenProducts');
  localStorage.removeItem('watenContent');
  localStorage.removeItem('watenSettings');
  localStorage.removeItem('watenUsers');
  localStorage.removeItem('watenCurrentUser');
  localStorage.removeItem('watenReviews');
  localStorage.removeItem('watenWishlist');
  
  showNotification('All data cleared successfully');
  setTimeout(() => {
    location.reload();
  }, 2000);
}

function exportAllData() {
  const allData = {
    orders: JSON.parse(localStorage.getItem('watenOrders')) || [],
    products: JSON.parse(localStorage.getItem('watenProducts')) || [],
    content: JSON.parse(localStorage.getItem('watenContent')) || {},
    settings: JSON.parse(localStorage.getItem('watenSettings')) || {},
    users: JSON.parse(localStorage.getItem('watenUsers')) || [],
    reviews: JSON.parse(localStorage.getItem('watenReviews')) || {},
    exportDate: new Date().toISOString()
  };
  
  const dataStr = JSON.stringify(allData, null, 2);
  const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
  
  const exportFileDefaultName = `waten-backup-${new Date().toISOString().split('T')[0]}.json`;
  
  const linkElement = document.createElement('a');
  linkElement.setAttribute('href', dataUri);
  linkElement.setAttribute('download', exportFileDefaultName);
  linkElement.click();
  
  showNotification('All data exported successfully');
}

function resetToDefaults() {
  if (!confirm('This will reset all content and settings to default values. Continue?')) return;
  
  // Reset content to defaults
  const defaultContent = {
    metaTitle: 'WATEN | Global Streetwear',
    metaDescription: 'WATEN ‚Äî Premium streetwear built for global dominance. Limited drops. Strong brand identity.',
    logo: 'WATEN',
    nav: 'COLLECTION|#collection\nINVEST|#invest\nAccount|#',
    heroTitle: 'WATEN',
    heroTagline: 'Built for global dominance',
    heroCta: 'Shop Now',
    collectionHeading: 'New Drop',
    collectionSubtitle: 'Limited edition pieces ‚Äî available now',
    investHeading: 'Invest in WATEN',
    investBody: 'WATEN is positioned for aggressive expansion across Tunisia and international markets. High-margin model. Limited drops. Strong brand identity. Seeking strategic investors to scale retail and global distribution.',
    investCta: 'Request Pitch Deck',
    footerLogo: 'WATEN',
    footerTagline: 'Premium streetwear. Limited drops. Global reach.',
    footerLinks: 'Collection|#collection\nInvest|#invest',
    footerCopyright: '¬© 2026 WATEN ‚Äî Global Streetwear'
  };
  
  localStorage.setItem('watenContent', JSON.stringify(defaultContent));
  
  // Reset settings to defaults
  const defaultSettings = {
    whatsapp: '',
    instagram: '',
    tiktok: '',
    email: ''
  };
  
  localStorage.setItem('watenSettings', JSON.stringify(defaultSettings));
  
  // Reset products to defaults
  const defaultProducts = [
    { id: 1, name: 'Black Essential Hoodie', price: 120, image: 'https://images.unsplash.com/photo-1602810319428-019690571b5b' },
    { id: 2, name: 'Oversized Street Tee', price: 80, image: 'https://images.unsplash.com/photo-1593032465171-8f8b8fdd6b47' },
    { id: 3, name: 'Limited Varsity Jacket', price: 250, image: 'images/iyadh.jpg' },
    { id: 4, name: 'Tataouine 3200 Hoodie', price: 140, image: '12.png' }
  ];
  
  localStorage.setItem('watenProducts', JSON.stringify(defaultProducts));
  
  showNotification('Reset to defaults successfully');
  loadContent();
  loadSettings();
  loadProducts();
}

// Admin Dashboard JavaScript
let orders = [];
let notifications = [];

function loadData() {
  // Load orders from localStorage or fetch from server
  const storedOrders = localStorage.getItem('watenOrders');
  const storedNotifications = localStorage.getItem('watenNotifications');
  
  orders = storedOrders ? JSON.parse(storedOrders) : [];
  notifications = storedNotifications ? JSON.parse(storedNotifications) : [];
  
  renderOrders();
  renderNotifications();
  updateStats();
}

function setupEventListeners() {
  // Status filter
  document.getElementById('status-filter').addEventListener('change', renderOrders);
  
  // Search box
  document.getElementById('search-box').addEventListener('input', renderOrders);
  
  // Close modal on backdrop click
  document.getElementById('order-modal').addEventListener('click', function(e) {
    if (e.target === this) closeModal('order-modal');
  });
}

function renderOrders() {
  const statusFilter = document.getElementById('status-filter').value;
  const searchTerm = document.getElementById('search-box').value.toLowerCase();
  
  const filteredOrders = orders.filter(order => {
    const matchesStatus = statusFilter === 'all' || order.status === statusFilter;
    const matchesSearch = !searchTerm || 
      order.orderId.toLowerCase().includes(searchTerm) ||
      order.customer.name.toLowerCase().includes(searchTerm) ||
      order.product.name.toLowerCase().includes(searchTerm) ||
      order.customer.phone.includes(searchTerm);
    
    return matchesStatus && matchesSearch;
  });
  
  const ordersList = document.getElementById('orders-list');
  
  if (filteredOrders.length === 0) {
    ordersList.innerHTML = `
      <div style="text-align: center; padding: 3rem; color: var(--text-muted);">
        No orders found
      </div>
    `;
    return;
  }
  
  ordersList.innerHTML = filteredOrders.map(order => `
    <div class="order-item" onclick="showOrderDetails('${order.orderId}')">
      <div class="order-header">
        <div class="order-id">${order.orderId}</div>
        <div class="order-status status-${order.status}">${order.status}</div>
      </div>
      <div class="order-details">
        <div class="detail-group">
          <div class="detail-label">Customer</div>
          <div class="detail-value">${order.customer.name}</div>
          <div class="detail-label">Phone</div>
          <div class="detail-value">${order.customer.phone}</div>
          <div class="detail-label">Email</div>
          <div class="detail-value">${order.customer.email}</div>
        </div>
        <div class="detail-group">
          <div class="detail-label">Product</div>
          <div class="detail-value">${order.product.name}</div>
          <div class="detail-label">Quantity</div>
          <div class="detail-value">${order.quantity}</div>
          <div class="detail-label">Total</div>
          <div class="detail-value">${order.totalPrice} TND</div>
          <div class="detail-label">Date</div>
          <div class="detail-value">${new Date(order.orderDate).toLocaleDateString()}</div>
        </div>
      </div>
    </div>
  `).join('');
}

function renderNotifications() {
  const notificationsList = document.getElementById('notifications-list');
  
  if (notifications.length === 0) {
    notificationsList.innerHTML = `
      <div style="text-align: center; padding: 2rem; color: var(--text-muted);">
        No notifications
      </div>
    `;
    return;
  }
  
  notificationsList.innerHTML = notifications.slice(0, 10).map(notification => `
    <div class="notification-item">
      <div class="notification-time">
        ${new Date(notification.timestamp).toLocaleString()}
      </div>
      <div class="notification-message">
        <strong>New Order:</strong> ${notification.customerName} - ${notification.product}
        <br><small>Total: ${notification.totalPrice} TND</small>
      </div>
    </div>
  `).join('');
}

function updateStats() {
  const totalOrders = orders.length;
  const totalRevenue = orders.reduce((sum, order) => sum + order.totalPrice, 0);
  const pendingOrders = orders.filter(order => order.status === 'pending').length;
  
  document.getElementById('total-orders').textContent = totalOrders;
  document.getElementById('total-revenue').textContent = totalRevenue.toFixed(2);
  document.getElementById('pending-orders').textContent = pendingOrders;
}

function showOrderDetails(orderId) {
  const order = orders.find(o => o.orderId === orderId);
  if (!order) return;
  
  const detailsContent = document.getElementById('order-details-content');
  detailsContent.innerHTML = `
    <div class="order-details">
      <div class="detail-group">
        <div class="detail-label">Order ID</div>
        <div class="detail-value">${order.orderId}</div>
        <div class="detail-label">Status</div>
        <div class="detail-value">
          <select class="filter-select" onchange="updateOrderStatus('${order.orderId}', this.value)">
            <option value="pending" ${order.status === 'pending' ? 'selected' : ''}>Pending</option>
            <option value="confirmed" ${order.status === 'confirmed' ? 'selected' : ''}>Confirmed</option>
            <option value="shipped" ${order.status === 'shipped' ? 'selected' : ''}>Shipped</option>
            <option value="delivered" ${order.status === 'delivered' ? 'selected' : ''}>Delivered</option>
          </select>
        </div>
      </div>
      <div class="detail-group">
        <div class="detail-label">Customer Name</div>
        <div class="detail-value">${order.customer.name}</div>
        <div class="detail-label">Phone</div>
        <div class="detail-value">${order.customer.phone}</div>
        <div class="detail-label">Email</div>
        <div class="detail-value">${order.customer.email}</div>
      </div>
      <div class="detail-group">
        <div class="detail-label">Address</div>
        <div class="detail-value">${order.customer.address}</div>
        <div class="detail-label">City</div>
        <div class="detail-value">${order.customer.city}</div>
        <div class="detail-label">Postal Code</div>
        <div class="detail-value">${order.customer.postalCode}</div>
      </div>
      <div class="detail-group">
        <div class="detail-label">Product</div>
        <div class="detail-value">${order.product.name}</div>
        <div class="detail-label">Price</div>
        <div class="detail-value">${order.product.price} TND</div>
        <div class="detail-label">Quantity</div>
        <div class="detail-value">${order.quantity}</div>
        <div class="detail-label">Total</div>
        <div class="detail-value">${order.totalPrice} TND</div>
      </div>
      <div class="detail-group">
        <div class="detail-label">Order Date</div>
        <div class="detail-value">${new Date(order.orderDate).toLocaleString()}</div>
        <div class="detail-label">Notes</div>
        <div class="detail-value">${order.notes || 'No notes'}</div>
      </div>
    </div>
    <div style="margin-top: 1.5rem; display: flex; gap: 1rem;">
      <button class="action-btn btn-primary" onclick="contactCustomer('${order.customer.phone}')">
        üìû Contact Customer
      </button>
      <button class="action-btn btn-secondary" onclick="printOrder('${order.orderId}')">
        üñ®Ô∏è Print Order
      </button>
    </div>
  `;
  
  document.getElementById('order-modal').style.display = 'flex';
}

function updateOrderStatus(orderId, newStatus) {
  const orderIndex = orders.findIndex(o => o.orderId === orderId);
  if (orderIndex !== -1) {
    orders[orderIndex].status = newStatus;
    localStorage.setItem('watenOrders', JSON.stringify(orders));
    updateStats();
    
    // Show success message
    showNotification(`Order ${orderId} status updated to ${newStatus}`);
  }
}

function closeModal(modalId) {
  document.getElementById(modalId).style.display = 'none';
}

function refreshData() {
  loadData();
  showNotification('Data refreshed successfully');
}

function exportOrders() {
  const exportData = {
    orders: orders,
    notifications: notifications,
    exportDate: new Date().toISOString()
  };
  
  const dataStr = JSON.stringify(exportData, null, 2);
  const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
  
  const exportFileDefaultName = 'waten-orders-' + new Date().toISOString().split('T')[0] + '.json';
  
  const linkElement = document.createElement('a');
  linkElement.setAttribute('href', dataUri);
  linkElement.setAttribute('download', exportFileDefaultName);
  linkElement.click();
  
  showNotification('Orders exported successfully');
}

function clearNotifications() {
  notifications = [];
  localStorage.setItem('watenNotifications', JSON.stringify(notifications));
  renderNotifications();
  showNotification('Notifications cleared');
}

function contactCustomer(phone) {
  window.open(`tel:${phone}`, '_blank');
}

function printOrder(orderId) {
  const order = orders.find(o => o.orderId === orderId);
  if (!order) return;
  
  const printWindow = window.open('', '_blank');
  printWindow.document.write(`
    <html>
      <head>
        <title>Order ${order.orderId}</title>
        <style>
          body { font-family: Arial, sans-serif; padding: 20px; }
          .header { border-bottom: 2px solid #c9a227; padding-bottom: 10px; margin-bottom: 20px; }
          .section { margin-bottom: 20px; }
          .label { font-weight: bold; color: #666; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>WATEN Order #${order.orderId}</h1>
        </div>
        <div class="section">
          <div class="label">Customer:</div> ${order.customer.name}<br>
          <div class="label">Phone:</div> ${order.customer.phone}<br>
          <div class="label">Email:</div> ${order.customer.email}
        </div>
        <div class="section">
          <div class="label">Product:</div> ${order.product.name}<br>
          <div class="label">Quantity:</div> ${order.quantity}<br>
          <div class="label">Total:</div> ${order.totalPrice} TND
        </div>
        <div class="section">
          <div class="label">Address:</div> ${order.customer.address}, ${order.customer.city}
        </div>
      </body>
    </html>
  `);
  printWindow.document.close();
  printWindow.print();
}

function showNotification(message) {
  const notification = document.createElement('div');
  notification.style.cssText = `
    position: fixed; top: 20px; right: 20px; background: var(--accent);
    color: var(--bg-dark); padding: 1rem 1.5rem; border-radius: 8px;
    z-index: 10001; font-weight: 600; box-shadow: 0 4px 20px rgba(201, 162, 39, 0.4);
    animation: slideIn 0.3s ease;
  `;
  notification.textContent = message;
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.style.opacity = '0';
    setTimeout(() => notification.remove(), 300);
  }, 3000);
}

function showSettings() {
  showNotification('Settings panel coming soon!');
}

function startRealTimeUpdates() {
  // Listen for new orders from main site
  window.addEventListener('storage', function(e) {
    if (e.key === 'watenOrders') {
      loadData();
      showNotification('New order received!');
    }
  });
  
  // Poll for updates every 30 seconds
  setInterval(() => {
    loadData();
  }, 30000);
}

// Add CSS animation
const style = document.createElement('style');
style.textContent = `
  @keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }
`;
document.head.appendChild(style);
</script>

</body>
</html>
                                        
